{{- $pctx := . -}}
{{- if .IsHome -}}{{ $pctx = .Site }}{{- end -}}
{{- $pages := slice -}}
{{- if or $.IsHome $.IsSection -}}
{{- $pages = $pctx.RegularPages -}}
{{- else -}}
{{- $pages = $pctx.Pages -}}
{{- end -}}
{{- $limit := .Site.Config.Services.RSS.Limit -}}
{{- if ge $limit 1 -}}
{{- $pages = $pages | first $limit -}}
{{- end -}}
{{- printf "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>" | safeHTML }}
<rss version="2.0" 
     xmlns:itunes="http://www.itunes.com/dtds/podcast-1.0.dtd"
     xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>{{ .Site.Title }} - Podcast</title>
    <link>{{ .Permalink }}</link>
    <description>{{ with .Site.Params.description }}{{ . }}{{ end }}</description>
    <language>hu</language>
    <lastBuildDate>{{ now.Format "Mon, 02 Jan 2006 15:04:05 -0700" }}</lastBuildDate>
    {{- with .Site.Params.podcast }}
    <itunes:author>{{ $.Site.Params.author }}</itunes:author>
    <itunes:summary>{{ $.Site.Params.description }}</itunes:summary>
    <itunes:owner>
      <itunes:name>{{ $.Site.Params.author }}</itunes:name>
      {{- with .email }}
      <itunes:email>{{ . }}</itunes:email>
      {{- end }}
    </itunes:owner>
    {{- with .image }}
    <itunes:image href="{{ . }}"/>
    {{- end }}
    {{- with .category }}
    <itunes:category text="{{ . }}"/>
    {{- end }}
    <itunes:explicit>{{ default "no" .explicit }}</itunes:explicit>
    {{- end }}
    {{- range $pages }}
    <item>
      <title>{{ .Title }}</title>
      <link>{{ .Permalink }}</link>
      <pubDate>{{ .Date.Format "Mon, 02 Jan 2006 15:04:05 -0700" }}</pubDate>
      <guid>{{ .Permalink }}</guid>
      <description>{{ with .Params.description }}{{ . }}{{ end }}</description>
      {{- with .Params.audioFile }}
      <enclosure url="{{ . | absURL }}" type="audio/mpeg"/>
      {{- end }}
      {{- with .Params.duration }}
      <itunes:duration>{{ . }}</itunes:duration>
      {{- end }}
    </item>
    {{- end }}
  </channel>
</rss>
